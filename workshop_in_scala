start your spark shell with following command .
spark-shell --packages com.databricks:spark-csv_2.11:1.2.0




val df = sqlContext.read.format("com.databricks.spark.csv").option("header", "true").option("inferSchema", "true").load("/Users/anand.ranganathan/github/spark_workshop_at_alpine_labs/resources/adult.data")


import org.apache.spark.mllib.linalg.Vectors
import org.apache.spark.ml.feature.VectorAssembler
import org.apache.spark.ml.feature.StringIndexer
import org.apache.spark.ml.Pipeline
import org.apache.spark.ml.classification.{DecisionTreeClassificationModel, DecisionTreeClassifier}




val output=assembler.transform(df)
output.select("features").take(10).foreach(println)


val assembler = new VectorAssembler().setInputCols(Array("age", "education-num")).setOutputCol("features")

val indexer = new StringIndexer().setInputCol("category").setOutputCol("category-index")




val pipeline = new Pipeline()

val model=pipeline.fit(df)
prepared = model.transform(df)

val pipeline = new Pipeline().setStages(Array(assembler, indexer))
 
val model = pipeline.fit(df)

val prepared = model.transform(df)

val classifier  = new DecisionTreeClassifier().setFeaturesCol("features").setLabelCol("category-index") 

val classifier_model = classifier.fit(prepared)


val pipeline_and_model = new Pipeline().setStages(Array(assembler,indexer,classifier_model))
val pipeline_model = pipeline_and_model.fit(df)


classifier_model.transform(prepared).select("prediction", "category-index").take(20)


import org.apache.spark.ml.feature.IndexToString



